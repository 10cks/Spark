(self.webpackChunkspark=self.webpackChunkspark||[]).push([[179],{80485:(e,t,n)=>{"use strict";var r=n(67294),i=n(73935),o=n(39711),a=n(96974),l=n(93230),c=n(13175),s=n(93379),u=(s=n.n(s),n(7795)),d=(u=n.n(u),n(90569)),f=(d=n.n(d),n(3565)),p=(f=n.n(f),n(19216)),h=(p=n.n(p),n(44589)),m=(h=n.n(h),n(30788));function y(){return r.createElement("div",{style:{userSelect:"none",fontWeight:500}},"Spark")}(v={}).styleTagTransform=h(),v.setAttributes=f(),v.insert=d().bind(null,"head"),v.domAPI=u(),v.insertStyleElement=p(),s()(m.Z,v),m.Z&&m.Z.locals&&m.Z.locals;var v=n(9669),b=n.n(v),w=n(48086),g=(m=n(27484),n.n(m)),k=(v=n(87767),(m={}).styleTagTransform=h(),m.setAttributes=f(),m.insert=d().bind(null,"head"),m.domAPI=u(),m.insertStyleElement=p(),s()(v.Z,m),v.Z&&v.Z.locals&&v.Z.locals,n(26946),n(33852),n(90336)),S=n(97409),A=n(50146),x=n(71577),E=n(59667),I=(m=n(80129),n.n(m));function O(e,t,n,r,i){return n=null!=n?n:{},n=Object.assign({"Content-Type":"application/x-www-form-urlencoded"},n),b()(Object.assign({url:e,data:t,method:"post",headers:n,transformRequest:i?[]:[I().stringify]},null!=r?r:{}))}function M(e){var t;return e=null!=(t=e)?t:100,new Promise((function(t){setTimeout((function(){t(!0)}),e)}))}function C(e){if(0===e)return"Unknown";var t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(2)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]}function j(e){if(isNaN(e))return"Unknown";var t=Math.floor(e/3600);e%=3600,e=Math.floor(e/60);return"".concat(t,"小时").concat(e,"分钟")}function T(e,t,n){var r,i,o=document.createElement("form");for(r in o.action=e,o.method="POST",o.target="_self",n)o[r]=n[r];for(i in t){var a=document.createElement("input");a.name=i,a.value=t[i],o.appendChild(a)}document.body.appendChild(o).submit(),o.remove()}var P=n(12320),R=n(67511),Z=n(12617),N=(v=n(23279),n.n(v)),L=(m=n(81354),n.n(m));function U(e){return(U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Y(e){for(var t,n,r,i=new Uint8Array(e),o="",a=i.length,l=0;l<a;)switch((t=i[l++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(t);break;case 12:case 13:n=i[l++],o+=String.fromCharCode((31&t)<<6|63&n);break;case 14:n=i[l++],r=i[l++],o+=String.fromCharCode((15&t)<<12|(63&n)<<6|(63&r)<<0)}return o}function _(e){for(var t=e.sigBytes,n=e.words,r=new Uint8Array(t),i=0,o=0;i!==t;){var a=n[o++];if(r[i++]=(4278190080&a)>>>24,i===t)break;if(r[i++]=(16711680&a)>>>16,i===t)break;if(r[i++]=(65280&a)>>>8,i===t)break;r[i++]=255&a}return r}n(77502);const F=function(e){var t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&z(t,e);var n=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B(e);if(n=t?(n=B(this).constructor,Reflect.construct(r,arguments,n)):r.apply(this,arguments),r=this,n&&("object"===U(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return W(r)}}(i);function i(e){if(this instanceof i)return(e=n.call(this,e)).ticker=0,e.ws=null,e.conn=!1,e.opened=!1,e.termRef=(0,r.createRef)(),e.secret=L().enc.Hex.parse(function(e){return function(e){if(Array.isArray(e))return H(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Array(32)).map((function(){return Math.floor(16*Math.random()).toString(16)})).join("")),e.termEv=null,e.term=new P.Terminal({convertEol:!0,allowTransparency:!1,cursorBlink:!0,cursorStyle:"block",fontFamily:"Hack, monospace",fontSize:16,logLevel:"off"}),e.doResize.call(W(e)),e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"initialize",value:function(e){var t=this,n="",r="",i=null;i=this.term.onData((function(e){if(t.conn)switch(e){case"":t.term.write("^C"),t.sendInput("");break;case"\r":t.term.write("\n"),t.sendInput(n+"\n"),r=n+"\n",n="";break;case"":0<n.length&&(n=n.substring(0,n.length-1),t.term.write("\b \b"));break;default:if(e>=String.fromCharCode(32)&&e<=String.fromCharCode(123)||" "<=e)return n+=e,void t.term.write(e)}else"\r"!==e&&" "!==e||(t.term.write("\n正在重新连接...\n"),t.initialize(i))}));return this.ws=new WebSocket("".concat(("https:"===location.protocol?"wss://":"ws://").concat(location.host).concat(location.pathname,"api/device/terminal"),"?device=").concat(this.props.device,"&secret=").concat(this.secret)),this.ws.binaryType="arraybuffer",this.ws.onopen=function(){t.conn=!0,null!=e&&e.dispose()},this.ws.onmessage=function(e){var n;e=t.decrypt(e.data);try{e=JSON.parse(e)}catch(e){}t.conn&&((e=Y("string"!=typeof(n=null==(n=e)||null==(n=n.data)?void 0:n.output)||null===(n=n.match(/.{1,2}/g))?new Uint8Array([]):new Uint8Array(n.map((function(e){return parseInt(e,16)})))))===r?r="":t.term.write(e))},this.ws.onclose=function(e){t.conn&&(t.conn=!1,t.term.write("\n连接已断开！\n"))},this.ws.onerror=function(e){t.conn&&(t.conn=!1,t.term.write("\n连接已断开！\n"))},i}},{key:"encrypt",value:function(e){return e=JSON.stringify(e),e=L().enc.Utf8.parse(e),_(L().AES.encrypt(e,this.secret,{mode:L().mode.CTR,iv:this.secret,padding:L().pad.NoPadding}).ciphertext)}},{key:"decrypt",value:function(e){return e=L().lib.WordArray.create(e),Y(_(L().AES.encrypt(e,this.secret,{mode:L().mode.CTR,iv:this.secret,padding:L().pad.NoPadding}).ciphertext).buffer)}},{key:"sendInput",value:function(e){this.conn&&this.sendData({act:"inputTerminal",data:{input:L().enc.Hex.stringify(L().enc.Utf8.parse(e))}})}},{key:"sendData",value:function(e){this.conn&&this.ws.send(this.encrypt(e))}},{key:"componentDidUpdate",value:function(e){e.visible?(clearInterval(this.ticker),this.conn&&this.ws.close(),this.termEv.dispose(),this.termEv=null):this.props.visible&&(this.opened||(this.opened=!0,this.fit=new Z.FitAddon,this.term.loadAddon(this.fit),this.term.loadAddon(new R.WebLinksAddon),this.term.open(this.termRef.current),this.fit.fit(),this.term.focus(),window.onresize=this.onResize.bind(this)),this.term.clear(),this.termEv=this.initialize(null),setInterval((function(){this.conn&&this.sendData({act:"heartbeat"})}),1500))}},{key:"componentWillUnmount",value:function(){window.onresize=null,this.conn&&this.ws.close(),this.term.dispose()}},{key:"doResize",value:function(){var e,t,n=document.body.clientHeight/42;null!=this&&null!=(t=this.fit)&&null!=(e=t.fit)&&e.call(t),null!=this&&null!=(e=this.term)&&null!=(t=e.resize)&&t.call(e,null==this||null==(t=this.term)?void 0:t.cols,parseInt(n)),null!=this&&null!=(e=this.term)&&null!=(t=e.scrollToBottom)&&t.call(e)}},{key:"onResize",value:function(){"function"==typeof this.doResize&&N()(this.doResize.bind(this),70)}},{key:"render",value:function(){return r.createElement(A.Z,{title:"Terminal",visible:this.props.visible,onCancel:this.props.onCancel,destroyOnClose:!1,footer:null,height:150,width:900},r.createElement("div",{ref:this.termRef}))}}])&&D(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(r.Component);var q=n(75443);function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function Q(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,i)}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const V=function(e){var t=(i=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useState)(!1),2))[0],n=i[1],i=[{key:"Name",title:"Name",dataIndex:"name",ellipsis:!0,width:120},{key:"Pid",title:"Pid",dataIndex:"pid",ellipsis:!0,width:40},{key:"Option",width:40,title:"操作",dataIndex:"name",valueType:"option",ellipsis:!0,render:function(t,n){return[r.createElement(q.Z,{key:"kill",title:"确定要结束该进程吗？",onConfirm:function(t){O("/api/device/process/kill",{pid:t,device:e.device}).then((function(e){0===e.data.code&&(w.ZP.success("进程已结束"),o.current.reload())}))}.bind(null,n.pid)},r.createElement("a",null,"结束"))]}}],o=(0,r.useRef)();function a(){var t;return t=regeneratorRuntime.mark((function t(r){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M(300);case 2:return t.next=4,O("/api/device/process/list",{device:e.device});case 4:if(i=t.sent,n(!1),0===(i=i.data).code)return i.data.processes=i.data.processes.sort((function(e,t){return t.pid-e.pid})),t.abrupt("return",{data:i.data.processes,success:!0,total:i.data.processes.length});t.next=10;break;case 10:return t.abrupt("return",{data:[],success:!1,total:0});case 11:case"end":return t.stop()}}),t)})),(a=function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){Q(o,r,i,a,l,"next",e)}function l(e){Q(o,r,i,a,l,"throw",e)}a(void 0)}))}).apply(this,arguments)}return(0,r.useEffect)((function(){e.visible&&n(!1)}),[e.device,e.visible]),r.createElement(A.Z,J({destroyOnClose:!0,title:"Process Manager",footer:null,height:500,width:400,bodyStyle:{padding:0}},e),r.createElement(k.ZP,{rowKey:"pid",tableStyle:{minHeight:"350px",maxHeight:"350px"},toolbar:{actions:[]},scroll:{scrollToFirstRowOnChange:!0,y:300},search:!1,size:"small",loading:t,onLoadingChange:n,options:{show:!0,density:!1,setting:!1},columns:i,request:function(e){return a.apply(this,arguments)},pagination:!1,actionRef:o}))};var K=n(88581),$=n(24739),X=n(5966),ee=n(31199),te=n(8214);const ne=JSON.parse('[{"value":"android","label":"Android","children":[{"value":"armv7a","label":"arm7a"},{"value":"aarch64","label":"aarch64"},{"value":"i686","label":"i686"},{"value":"x86_64","label":"x86_64"}]},{"value":"linux","label":"Linux","children":[{"value":"arm","label":"arm"},{"value":"arm64","label":"arm64"},{"value":"i386","label":"i386"},{"value":"amd64","label":"amd64"}]},{"value":"windows","label":"Windows","children":[{"value":"arm","label":"arm"},{"value":"arm64","label":"arm64"},{"value":"i386","label":"i386"},{"value":"amd64","label":"amd64"}]}]');function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function ie(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,i)}const oe=function(e){var t=function(){var e={host:location.hostname,port:location.port,path:location.pathname,ArchOS:["windows","amd64"]};return 0===String(location.port).length&&(e.port="https:"===location.protocol?443:80),e}();function n(){var e;return e=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:2===(null==t||null==(n=t.ArchOS)?void 0:n.length)&&(t.os=t.ArchOS[0],t.arch=t.ArchOS[1],delete t.ArchOS),t.secure="https:"===location.protocol?"true":"false",O((r=location.origin+location.pathname+"api/client/")+"check",t).then((function(e){0===e.data.code&&T(r+="generate",t)})).catch();case 4:case"end":return e.stop()}}),e)})),(n=function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ie(o,r,i,a,l,"next",e)}function l(e){ie(o,r,i,a,l,"throw",e)}a(void 0)}))}).apply(this,arguments)}return r.createElement(K.Y,re({modalProps:{destroyOnClose:!0},initialValues:t,onFinish:function(e){return n.apply(this,arguments)},submitter:{render:function(e,t){return t.pop()}}},e),r.createElement($.UW,null,r.createElement(X.Z,{width:"md",name:"host",label:"Host",rules:[{required:!0}]}),r.createElement(ee.Z,{width:"md",name:"port",label:"Port",min:1,max:65535,rules:[{required:!0}]})),r.createElement($.UW,null,r.createElement(X.Z,{width:"md",name:"path",label:"Path",rules:[{required:!0}]}),r.createElement(te.Z,{width:"md",name:"ArchOS",label:"OS & Arch",request:function(){return ne},rules:[{required:!0}]})))};function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function le(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,i)}function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}v=n(15681),(m={}).styleTagTransform=h(),m.setAttributes=f(),m.insert=d().bind(null,"head"),m.domAPI=u(),m.insertStyleElement=p(),s()(v.Z,m),v.Z&&v.Z.locals&&v.Z.locals;const ue=function(e){var t=(a=ce((0,r.useState)("/"),2))[0],n=a[1],i=(a=ce((0,r.useState)(!1),2))[0],o=a[1],a=[{key:"Name",title:"Name",dataIndex:"name",ellipsis:!0,width:180},{key:"Size",title:"Size",dataIndex:"size",ellipsis:!0,width:60,renderText:function(e,t){return 0===t.type?C(e):"-"}},{key:"Time",title:"Time Modified",dataIndex:"time",ellipsis:!0,width:100,renderText:function(e,t){return 0===t.type?g().unix(e).format("YYYY/MM/DD HH:mm"):"-"}},{key:"Option",width:120,title:"操作",dataIndex:"name",valueType:"option",ellipsis:!0,render:function(n,i){var o=i,a=r.createElement(q.Z,{key:"remove",title:"确定要删除该"+(0===o.type?"文件":"目录")+"吗？",onConfirm:function(n){O("/api/device/file/remove",{path:t+n,device:e.device}).then((function(e){0===e.data.code&&(w.ZP.success("文件或目录已被删除"),l.current.reload())}))}.bind(null,o.name)},r.createElement("a",null,"删除"));switch(o.type){case 0:return[r.createElement("a",{key:"download",onClick:function(n){T(location.origin+location.pathname+"api/device/file/get",{file:t+n,device:e.device})}.bind(null,o.name)},"下载"),a];case 1:return[a];case 2:return[]}return[]}}],l=(0,r.useRef)();function c(e){n(e),l.current.reload()}function s(){var n=e.isWindows?"\\":"/",r=t.substring(0,t.length-1).split(n);return r.pop(),0===r.length?"/":r.join(n)+n}function u(){var r;return r=regeneratorRuntime.mark((function r(i){var a,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M(300);case 2:return r.next=4,O("/api/device/file/list",{path:t,device:e.device});case 4:if(a=r.sent,o(!1),0===(a=a.data).code)return l=!1,a.data.files=a.data.files.sort((function(e,t){return t.type-e.type})),0<t.length&&"/"!==t&&"\\"!==t&&(l=!0,a.data.files.unshift({name:"..",size:"0",type:3,modTime:0})),r.abrupt("return",{data:a.data.files,success:!0,total:a.data.files.length-(l?1:0)});r.next=12;break;case 12:return n(s()),r.abrupt("return",{data:[],success:!1,total:0});case 14:case"end":return r.stop()}}),r)})),(u=function(){var e=this,t=arguments;return new Promise((function(n,i){var o=r.apply(e,t);function a(e){le(o,n,i,a,l,"next",e)}function l(e){le(o,n,i,a,l,"throw",e)}a(void 0)}))}).apply(this,arguments)}return(0,r.useEffect)((function(){n("/"),e.visible&&o(!1)}),[e.device,e.visible]),r.createElement(A.Z,ae({destroyOnClose:!0,title:"File Explorer",footer:null,height:500,width:800,bodyStyle:{padding:0}},e),r.createElement(k.ZP,{rowKey:"name",onRow:function(n){return{onDoubleClick:function(n){var r=e.isWindows?"\\":"/";".."===n.name?c(s()):0!==n.type&&(!e.isWindows||"/"!==t&&"\\"!==t&&0!==t.length?c(t+n.name+r):c(n.name+r))}.bind(null,n)}},tableStyle:{minHeight:"350px",maxHeight:"350px"},toolbar:{actions:[]},scroll:{scrollToFirstRowOnChange:!0,y:300},search:!1,size:"small",loading:i,rowClassName:"file-row",onLoadingChange:o,options:{show:!0,density:!1,setting:!1},columns:a,request:function(e){return u.apply(this,arguments)},pagination:!1,actionRef:l}))};var de=n(1870);function fe(){return(fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function pe(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,i)}function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){l=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ye(e){var t=(f=he((0,r.useState)(""),2))[0],n=f[1],i=(f=he((0,r.useState)(!1),2))[0],o=f[1],a=(f=he((0,r.useState)(!1),2))[0],l=f[1],c=(f=he((0,r.useState)(!1),2))[0],s=f[1],u=(f=he((0,r.useState)(!1),2))[0],d=f[1],f=[{key:"Hostname",title:"Hostname",dataIndex:"hostname",ellipsis:!0,width:100},{key:"Username",title:"Username",dataIndex:"username",ellipsis:!0,width:100},{key:"OS",title:"OS",dataIndex:"os",ellipsis:!0,width:80},{key:"Arch",title:"Arch",dataIndex:"arch",ellipsis:!0,width:70},{key:"Mac",title:"Mac",dataIndex:"mac",ellipsis:!0,width:100},{key:"LAN",title:"LAN",dataIndex:"lan",ellipsis:!0,width:100},{key:"WAN",title:"WAN",dataIndex:"wan",ellipsis:!0,width:100},{key:"Mem",title:"Mem",dataIndex:"mem",ellipsis:!0,renderText:C,width:70},{key:"Uptime",title:"Uptime",dataIndex:"uptime",ellipsis:!0,renderText:j,width:100},{key:"Option",width:180,title:"操作",dataIndex:"id",valueType:"option",ellipsis:!0,render:function(e,i){return a=i,[r.createElement("a",{key:"terminal",onClick:o.bind(null,a.id)},"终端"),r.createElement("a",{key:"procmgr",onClick:l.bind(null,a.id)},"进程"),r.createElement("a",{key:"browser",onClick:function(){s(a.id),d("windows"===a.os)}},"文件"),r.createElement(S.Z,{key:"more",onSelect:function(e){var i,o;i=e,o=a.id,"screenshot"===i?O("/api/device/screenshot/get",{device:o},{},{responseType:"blob"}).then((function(e){var r;"application/json"===(null!=(r=e.data.type)?r:"").substring(0,16)?e.data.text().then((function(e){var t={};try{t=JSON.parse(e)}catch(e){}w.ZP.warn(null!=(e=t.msg)?e:"请求服务器失败")})):(0<t.length&&URL.revokeObjectURL(t),n(URL.createObjectURL(e.data)))})):(e={lock:"锁屏",logoff:"注销",hibernate:"休眠",suspend:"睡眠",restart:"重启",shutdown:"关机",offline:"离线"}).hasOwnProperty(i)&&A.Z.confirm({title:"确定要".concat(e[i],"该设备吗？"),icon:r.createElement(de.Z,null),okText:"确定",cancelText:"取消",onOk:function(){O("/api/device/"+i,{device:o}).then((function(e){0===e.data.code&&(w.ZP.success("操作已执行"),p.current.reload())}))}})},menus:[{key:"screenshot",name:"截屏"},{key:"lock",name:"锁屏"},{key:"logoff",name:"注销"},{key:"hibernate",name:"休眠"},{key:"suspend",name:"睡眠"},{key:"restart",name:"重启"},{key:"shutdown",name:"关机"},{key:"offline",name:"离线"}]})];var a}}],p=(0,r.useRef)();function h(){var e;return e=regeneratorRuntime.mark((function e(t){var n,r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(300);case 2:return e.next=4,O("/api/device/list");case 4:if(n=e.sent,0!==(r=n.data).code){e.next=12;break}for(o in i=[],r.data)(a=r.data[o]).conn=o,i.push(a);return i=(i=i.sort((function(e,t){return(e=e.hostname.toUpperCase())<(t=t.hostname.toUpperCase())?-1:t<e?1:0}))).sort((function(e,t){return(e=e.os.toUpperCase())<(t=t.os.toUpperCase())?-1:t<e?1:0})),e.abrupt("return",{data:i,success:!0,total:i.length});case 12:return e.abrupt("return",{data:[],success:!1,total:0});case 13:case"end":return e.stop()}}),e)})),(h=function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){pe(o,r,i,a,l,"next",e)}function l(e){pe(o,r,i,a,l,"throw",e)}a(void 0)}))}).apply(this,arguments)}return r.createElement(r.Fragment,null,r.createElement(E.Z,{preview:{visible:t,src:t,onVisibleChange:function(){URL.revokeObjectURL(t),n("")}}}),r.createElement(ue,{isWindows:u,visible:c,device:c,onCancel:s.bind(null,!1)}),r.createElement(V,{visible:a,device:a,onCancel:l.bind(null,!1)}),r.createElement(F,{visible:i,device:i,onCancel:o.bind(null,!1)}),r.createElement(k.ZP,{rowKey:"id",search:!1,options:{show:!0,density:!0,setting:!1},columns:f,request:function(e){return h.apply(this,arguments)},pagination:!1,actionRef:p,toolBarRender:function(){return r.createElement(oe,{title:"生成客户端",trigger:r.createElement(x.Z,{type:"primary"},"生成客户端")})}}))}function ve(e,t,n,r,i,o,a){try{var l=e[o](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,i)}g().locale("zh-cn"),b().defaults.baseURL=".",b().interceptors.response.use(function(){e=regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.data).hasOwnProperty("code")&&0!==n.code&&w.ZP.warn(n.msg),e.abrupt("return",Promise.resolve(t));case 3:case"end":return e.stop()}}),e)}));var e,t=function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ve(o,r,i,a,l,"next",e)}function l(e){ve(o,r,i,a,l,"throw",e)}a(void 0)}))};return function(e){return t.apply(this,arguments)}}(),(function(e){var t=(e=e.response).data;return t.hasOwnProperty("code")&&0!==t.code&&w.ZP.warn(t.msg),Promise.resolve(e)})),i.render(r.createElement(o.UT,null,r.createElement(a.Z5,null,r.createElement(a.AW,{path:"/",element:r.createElement((function(e){return r.createElement(l.ZP,{loading:!1,title:"Spark",layout:"top",navTheme:"light",collapsed:!0,fixedHeader:!0,contentWidth:"fluid",collapsedButtonRender:y},r.createElement(c.ZP,null,e.children))}),null,r.createElement((function(e){return r.createElement(ye,fe({},e,{key:Math.random()}))}),null))}),r.createElement(a.AW,{path:"*",element:r.createElement((function(){return r.createElement("h1",{style:{textAlign:"center",userSelect:"none"}},"Page Not Found.",r.createElement("br",null),"未找到该页面。")}),null)}))),document.getElementById("root"))},15681:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});t=n(8081),t=n.n(t);var r=n(23645);(n=n.n(r)()(t())).push([e.id,".file-row {\r\n    user-select: none;\r\n    cursor: pointer;\r\n}",""]);const i=n},30788:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});t=n(8081),t=n.n(t);var r=n(23645);(n=n.n(r)()(t())).push([e.id,".ant-page-header {\r\n    display: none;\r\n}\r\n\r\n.ant-pro-top-nav-header-logo {\r\n    user-select: none;\r\n}",""]);const i=n},87767:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});t=n(8081),t=n.n(t);var r=n(23645),i=(r=n.n(r),n(61667));i=n.n(i),n=new URL(n(8171),n.b),r=r()(t()),t=i()(n);r.push([e.id,"#root {\r\n    height: 100%;\r\n    background-image: url("+t+");\r\n    background-repeat: no-repeat;\r\n    background-position: center 110px;\r\n    background-color: #f0f2f5;\r\n    background-size: 100%;\r\n}\r\n\r\n.ant-table-cell {\r\n    border: none !important;\r\n}",""]);const o=r},52445:e=>{"use strict";e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTQuNSAyLjVoLTEzQS41LjUgMCAwIDAgMSAzdjEwYS41LjUgMCAwIDAgLjUuNWgxM2EuNS41IDAgMCAwIC41LS41VjNhLjUuNSAwIDAgMC0uNS0uNXpNNS4yODEgNC43NWExIDEgMCAwIDEgMCAyIDEgMSAwIDAgMSAwLTJ6bTguMDMgNi44M2EuMTI3LjEyNyAwIDAgMS0uMDgxLjAzSDIuNzY5YS4xMjUuMTI1IDAgMCAxLS4wOTYtLjIwN2wyLjY2MS0zLjE1NmEuMTI2LjEyNiAwIDAgMSAuMTc3LS4wMTZsLjAxNi4wMTZMNy4wOCAxMC4wOWwyLjQ3LTIuOTNhLjEyNi4xMjYgMCAwIDEgLjE3Ny0uMDE2bC4wMTUuMDE2IDMuNTg4IDQuMjQ0YS4xMjcuMTI3IDAgMCAxLS4wMi4xNzV6IiBmaWxsPSIjOEM4QzhDIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L3N2Zz4="},8171:(e,t,n)=>{"use strict";e.exports=n.p+"3bb7aeaa43694e7a1aa7.svg"},42480:()=>{},24654:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[216],(()=>(t(74445),t(80485)))),e.O()}]);